trainer:
  _target_: lightning.Trainer
  accelerator: auto
  devices: auto
  precision: 16-mixed
  # precision: bf16-mixed  # Preferred over "16-mixed" if supported for the GPU in use
  sync_batchnorm: true
  deterministic: false
  max_epochs: 160
  profiler: null
  logger:
    _target_: aim.sdk.adapters.pytorch_lightning.AimLogger
    experiment: tumorsemseg_v0
    train_metric_prefix: train_
    val_metric_prefix: val_
  callbacks:
    - _target_: lightning.pytorch.callbacks.early_stopping.EarlyStopping
      monitor: val_total_loss
      mode: min
      patience: 20
      min_delta: 1e-3
      verbose: true
    - _target_: lightning.pytorch.callbacks.ModelCheckpoint
      filename: "{epoch}-{val_mIoU:.2f}"
      monitor: val_mIoU
      mode: max
      save_last: true
      save_top_k: 1
    - _target_: lightning.pytorch.callbacks.model_summary.ModelSummary
      max_depth: -1
    - _target_: tumor_semseg.module.callbacks.ComputeIoUCallback
    - _target_: tumor_semseg.module.callbacks.PredVisualizationCallback
      log_every_n_batches: 16
